---
import DashboardLayout from '@layouts/DashboardLayout.astro'

import DataTableCard from '@components/datatable/DataTableCard.astro'

import AddModal from '@components/modals/AddModal.astro'
import DetailsOffcanvas from '@components/modals/DetailsOffcanvas.astro'
import EditModal from '@components/modals/EditModal.astro'
---

<DashboardLayout
  title="Autores"
  currentPage="/authors"
  role="administrador"
  username="Jason"
  customScriptPath="/js/modules/authors/authors.js"
>
  <DataTableCard title="Lista de autores" icon="bi-people" columnCount={7}>
    <Fragment slot="thead">
      <th scope="col" class="text-start">Código</th>
      <th scope="col" class="text-start">Nombre</th>
      <th scope="col" class="text-start">Nacionalidad</th>
      <th scope="col" class="text-start">Género literario</th>
      <th scope="col" class="text-center">Fecha nacimiento</th>
      <th scope="col" class="text-center">Estado</th>
      <th scope="col" class="text-center">Foto</th>
    </Fragment>
  </DataTableCard>

  <Fragment slot="modals">
    <AddModal title="Agregar un autor" useMultipart={true}>
      <!-- Personal Information Section -->
      <div class="row">
        <!-- Name Field -->
        <div class="col-md-6 mb-3">
          <label for="addName" class="form-label">Nombre <span class="text-danger">*</span></label>
          <input
            type="text"
            class="form-control"
            id="addName"
            name="name"
            pattern="[A-Za-zÀ-ÿ\s.]+"
            oninput="this.value = this.value.replace(/[^A-Za-zÀ-ÿ\s.]/g, '');"
            placeholder="Ingrese el nombre del autor"
            required
          />
          <div class="invalid-feedback"></div>
        </div>

        <!-- Nationality Field -->
        <div class="col-md-6 mb-3">
          <label for="addNationality" class="form-label"
            >Nacionalidad <span class="text-danger">*</span></label
          >
          <select
            class="selectpicker form-control placeholder-color"
            id="addNationality"
            name="nationality"
            data-live-search="true"
            data-live-search-placeholder="Buscar..."
            title="Seleccione una nacionalidad"
            required></select>
          <div class="invalid-feedback"></div>
        </div>
      </div>

      <!-- Details Section -->
      <div class="row">
        <!-- Literary Genre Field -->
        <div class="col-md-6 mb-3">
          <label for="addLiteraryGenre" class="form-label"
            >Género literario <span class="text-danger">*</span></label
          >
          <select
            class="selectpicker form-control placeholder-color"
            id="addLiteraryGenre"
            name="literaryGenre"
            data-live-search="true"
            data-live-search-placeholder="Buscar..."
            title="Seleccione un género literario"
            required></select>
          <div class="invalid-feedback"></div>
        </div>

        <!-- Birth Date Field -->
        <div class="col-md-6 mb-3">
          <label for="addBirthDate" class="form-label"
            >Fecha de nacimiento <span class="text-danger">*</span></label
          >
          <input type="date" class="form-control" id="addBirthDate" name="birthDate" required />
          <div class="invalid-feedback"></div>
        </div>
      </div>

      <!-- Additional Information Section -->
      <div class="row">
        <!-- Biography Field -->
        <div class="col-md-6 mb-3">
          <label for="addBiography" class="form-label">Biografía</label>
          <textarea
            class="form-control"
            id="addBiography"
            name="biography"
            rows="1"
            placeholder="Escribe una breve biografía"></textarea>
        </div>

        <!-- Status Field -->
        <div class="col-md-6 mb-3">
          <label for="addStatus" class="form-label">Estado <span class="text-danger">*</span></label
          >
          <select
            class="selectpicker form-control placeholder-color"
            id="addStatus"
            name="status"
            title="Seleccione un estado"
            required></select>
          <div class="invalid-feedback"></div>
        </div>
      </div>

      <!-- Photo Upload Section -->
      <div class="row">
        <div class="col-md-12 mb-3">
          <label for="addPhoto" class="form-label">Foto</label>
          <input type="file" class="form-control" id="addPhoto" accept="image/*" />
          <div class="invalid-feedback"></div>
        </div>
      </div>

      <!-- Default Photo Section -->
      <div class="row">
        <div class="col-md-12 d-flex justify-content-center">
          <div id="defaultAddPhotoContainer" class="text-center" style="max-width: 180px;">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="180"
              height="180"
              fill="currentColor"
              class="bi-person-circle"
              viewBox="0 0 16 16"
            >
              <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"></path>
              <path
                fill-rule="evenodd"
                d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"
              ></path>
            </svg>
          </div>
        </div>
      </div>

      <!-- Image Cropper Section -->
      <div id="cropperContainerAdd" class="d-none">
        <img id="imageToCropAdd" src="#" alt="Imagen" />
      </div>

      <!-- Delete Photo Section -->
      <div class="row">
        <div class="col-md-12 d-flex justify-content-center">
          <!-- Delete Photo Button -->
          <button
            type="button"
            class="btn btn-sm btn-danger d-flex align-items-center mt-2 d-none"
            id="deleteAddPhotoBtn"
          >
            <i class="bi bi-trash me-2"></i>
            Eliminar foto
          </button>
        </div>
      </div>
    </AddModal>

    <DetailsOffcanvas title="Detalles del autor">
      <!-- ID and Name Section -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <h6 class="small text-muted">Código</h6>
          <div class="placeholder-glow">
            <p class="badge bg-body-tertiary text-body-emphasis border d-none" id="detailsID"></p>
            <span
              class="placeholder placeholder-sm col-6 rounded mb-3"
              data-placeholder-for="detailsID"
              style="height: 25px;"></span>
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <h6 class="small text-muted">Nombre</h6>
          <div class="placeholder-glow">
            <p class="fw-bold d-none" id="detailsName"></p>
            <span
              class="placeholder placeholder-sm col-10 rounded mb-3"
              data-placeholder-for="detailsName"
              style="height: 25px;"></span>
          </div>
        </div>
      </div>

      <!-- Nationality and Literary Genre Section -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <h6 class="small text-muted">Nacionalidad</h6>
          <div class="placeholder-glow">
            <p class="d-none" id="detailsNationality"></p>
            <span
              class="placeholder placeholder-sm col-8 rounded mb-3"
              data-placeholder-for="detailsNationality"
              style="height: 25px;"></span>
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <h6 class="small text-muted">Género literario</h6>
          <div class="placeholder-glow">
            <p class="d-none" id="detailsLiteraryGenre"></p>
            <span
              class="placeholder placeholder-sm col-10 rounded mb-3"
              data-placeholder-for="detailsLiteraryGenre"
              style="height: 25px;"></span>
          </div>
        </div>
      </div>

      <!-- Birth Date and Status Section -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <h6 class="small text-muted">Fecha de nacimiento</h6>
          <div class="placeholder-glow">
            <p class="fw-bold d-none" id="detailsBirthDate"></p>
            <span
              class="placeholder placeholder-sm col-8 rounded mb-3"
              data-placeholder-for="detailsBirthDate"
              style="height: 25px;"></span>
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <h6 class="small text-muted">Estado</h6>
          <div class="placeholder-glow">
            <p class="d-none" id="detailsStatus"></p>
            <span
              class="placeholder placeholder-sm col-6 rounded mb-3"
              data-placeholder-for="detailsStatus"
              style="height: 25px;"></span>
          </div>
        </div>
      </div>

      <!-- Biography and Photo Section -->
      <div class="row">
        <div class="col-md-12 mb-3">
          <h6 class="small text-muted">Biografía</h6>
          <div class="placeholder-glow">
            <p class="fw-bold d-none" id="detailsBiography"></p>
            <span
              class="placeholder placeholder-sm col-12 rounded mb-3"
              data-placeholder-for="detailsBiography"
              style="height: 60px;"></span>
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <h6 class="small text-muted">Foto</h6>
          <div id="detailsPhoto" class="d-none">
            <svg
              id="detailsSvg"
              xmlns="http://www.w3.org/2000/svg"
              width="120"
              height="120"
              fill="currentColor"
              class="bi-person-circle d-none"
              viewBox="0 0 16 16"
            >
              <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"></path>
              <path
                fill-rule="evenodd"
                d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"
              ></path>
            </svg>
            <img
              id="detailsImg"
              src=""
              class="img-fluid rounded-circle d-none"
              style="width: 120px; height: 120px;"
              alt="Foto del usuario"
            />
          </div>

          <div class="placeholder-glow" style="height: 120px;">
            <div
              class="placeholder rounded-circle"
              style="width: 120px; height: 120px;"
              data-placeholder-for="detailsImg"
            >
            </div>
          </div>
        </div>
      </div>
    </DetailsOffcanvas>

    <EditModal name="Editar autor" useMultipart={true}>
      <div class="row">
        <!-- Name Field -->
        <div class="col-md-6 mb-3">
          <label for="editName" class="form-label">Nombre <span class="text-danger">*</span></label>
          <input
            type="text"
            class="form-control"
            id="editName"
            name="name"
            pattern="[A-Za-zÀ-ÿ\s.]+"
            oninput="this.value = this.value.replace(/[^A-Za-zÀ-ÿ\s.]/g, '');"
            placeholder="Ingrese el nombre del autor"
            required
          />
          <div class="invalid-feedback"></div>
        </div>

        <!-- Nationality Field -->
        <div class="col-md-6 mb-3">
          <label for="editNationality" class="form-label"
            >Nacionalidad <span class="text-danger">*</span></label
          >
          <select
            class="selectpicker form-control"
            id="editNationality"
            name="nationality"
            data-live-search="true"
            data-live-search-placeholder="Buscar..."
            required></select>
          <div class="invalid-feedback"></div>
        </div>
      </div>

      <!-- Details Section -->
      <div class="row">
        <!-- Literary Genre Field -->
        <div class="col-md-6 mb-3">
          <label for="editLiteraryGenre" class="form-label"
            >Género literario <span class="text-danger">*</span></label
          >
          <select
            class="selectpicker form-control"
            id="editLiteraryGenre"
            name="literaryGenre"
            data-live-search="true"
            data-live-search-placeholder="Buscar..."
            required></select>
          <div class="invalid-feedback"></div>
        </div>

        <!-- Birth Date Field -->
        <div class="col-md-6 mb-3">
          <label for="editBirthDate" class="form-label"
            >Fecha de nacimiento <span class="text-danger">*</span></label
          >
          <input type="date" class="form-control" id="editBirthDate" name="birthDate" required />
          <div class="invalid-feedback"></div>
        </div>
      </div>

      <!-- Additional Information Section -->
      <div class="row">
        <!-- Biography Field -->
        <div class="col-md-6 mb-3">
          <label for="editBiography" class="form-label">Biografía</label>
          <textarea
            class="form-control"
            id="editBiography"
            name="biography"
            rows="1"
            placeholder="Escribe una breve biografía"></textarea>
        </div>

        <!-- Status Field -->
        <div class="col-md-6 mb-3">
          <label for="editStatus" class="form-label"
            >Estado <span class="text-danger">*</span></label
          >
          <select class="selectpicker form-control" id="editStatus" name="status" required></select>
        </div>
      </div>

      <!-- Photo Upload Section -->
      <div class="row">
        <div class="col-md-12 mb-3">
          <label for="editPhoto" class="form-label">Foto</label>
          <input type="file" class="form-control" id="editPhoto" accept="image/*" />
          <div class="invalid-feedback"></div>
        </div>
      </div>

      <!-- Current Photo Section -->
      <div class="row">
        <div class="col-md-12 d-flex justify-content-center">
          <div id="currentEditPhotoContainer" class="text-center" style="max-width: 180px;">
            <!-- The current photo will be displayed here -->
          </div>
        </div>
      </div>

      <!-- Image Cropper Section -->
      <div id="cropperContainerEdit" class="d-none">
        <img id="imageToCropEdit" src="#" alt="Imagen" />
      </div>

      <!-- Delete Photo Section -->
      <div class="row">
        <div class="col-md-12 d-flex justify-content-center">
          <!-- Delete Photo Button -->
          <button
            type="button"
            class="btn btn-sm btn-danger d-flex align-items-center mt-2 d-none"
            id="deleteEditPhotoBtn"
          >
            <i class="bi bi-trash me-2"></i>
            Eliminar foto
          </button>
        </div>
      </div>
    </EditModal>
  </Fragment>
</DashboardLayout>
